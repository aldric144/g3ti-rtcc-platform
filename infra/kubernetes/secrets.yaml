apiVersion: v1
kind: Secret
metadata:
  name: rtcc-secrets
  namespace: rtcc-uip
  labels:
    app: rtcc-platform
    compliance: cjis
type: Opaque
stringData:
  database-url: "postgresql://rtcc_user:CHANGE_ME@pg-primary.rtcc-uip.svc.cluster.local:5432/rtcc"
  redis-url: "redis://:CHANGE_ME@redis.rtcc-uip.svc.cluster.local:6379/0"
  elasticsearch-url: "https://elastic:CHANGE_ME@es.rtcc-uip.svc.cluster.local:9200"
  neo4j-url: "bolt://neo4j:CHANGE_ME@neo4j.rtcc-uip.svc.cluster.local:7687"
  jwt-secret: "CHANGE_ME_TO_SECURE_JWT_SECRET"
  encryption-key: "CHANGE_ME_TO_32_BYTE_KEY"
---
apiVersion: v1
kind: Secret
metadata:
  name: rtcc-tls-certs
  namespace: rtcc-uip
  labels:
    app: rtcc-platform
type: kubernetes.io/tls
data:
  tls.crt: ""
  tls.key: ""
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: rtcc-external-secrets
  namespace: rtcc-uip
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: aws-secrets-manager
  target:
    name: rtcc-secrets-managed
    creationPolicy: Owner
  data:
  - secretKey: database-url
    remoteRef:
      key: rtcc/production/database
      property: url
  - secretKey: redis-url
    remoteRef:
      key: rtcc/production/redis
      property: url
  - secretKey: jwt-secret
    remoteRef:
      key: rtcc/production/jwt
      property: secret
  - secretKey: encryption-key
    remoteRef:
      key: rtcc/production/encryption
      property: key
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: api-gateway-config
  namespace: rtcc-uip
data:
  config.yaml: |
    server:
      port: 8080
      tls_port: 8443
      read_timeout: 30s
      write_timeout: 30s
      idle_timeout: 120s
    
    security:
      zero_trust_enabled: true
      cjis_compliance: strict
      mfa_required: true
      session_timeout: 30m
      max_failed_attempts: 5
      lockout_duration: 30m
    
    rate_limiting:
      enabled: true
      requests_per_minute: 1000
      burst_size: 100
    
    cors:
      allowed_origins:
        - https://rtcc.rivierabeach.gov
      allowed_methods:
        - GET
        - POST
        - PUT
        - DELETE
        - OPTIONS
      allowed_headers:
        - Authorization
        - Content-Type
        - X-Request-ID
      max_age: 3600
    
    logging:
      level: INFO
      format: json
      include_request_body: false
      include_response_body: false
    
    tracing:
      enabled: true
      sampling_rate: 0.1
      exporter: jaeger
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: ai-engine-config
  namespace: rtcc-uip
data:
  config.yaml: |
    engine:
      gpu_enabled: true
      model_cache_size: 10GB
      inference_timeout: 30s
      batch_size: 32
    
    ethics:
      bias_detection_enabled: true
      fairness_threshold: 0.8
      civil_rights_check: true
      audit_all_decisions: true
    
    models:
      predictive_policing:
        version: "3.0"
        path: /models/predictive
      entity_resolution:
        version: "2.1"
        path: /models/entity
      threat_assessment:
        version: "1.5"
        path: /models/threat
    
    riviera_beach:
      city_code: "33404"
      population: 37964
      area_sq_miles: 9.76
      coordinates:
        lat: 26.7753
        lon: -80.0583
